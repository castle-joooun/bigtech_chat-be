# MSA ë§ˆì´ê·¸ë ˆì´ì…˜ í˜„í™©

> **ì‘ì„±ì¼**: 2026-01-27
> **í˜„ì¬ ë‹¨ê³„**: Week 5 - MSA ì„œë¹„ìŠ¤ ë¶„ë¦¬ (êµ¬ì¡° ìƒì„± ì™„ë£Œ)

---

## ğŸ“Š ì „ì²´ ì§„í–‰ ìƒí™©

| Week | ì‘ì—… | ìƒíƒœ | ì™„ë£Œìœ¨ |
|------|------|------|--------|
| Week 1-2 | DDD Lite ì ìš© | âœ… ì™„ë£Œ | 100% |
| Week 3-4 | Kafka í†µí•© | âœ… ì™„ë£Œ | 100% |
| Week 5 | MSA ì„œë¹„ìŠ¤ ë¶„ë¦¬ | ğŸš§ ì§„í–‰ì¤‘ | 75% |
| Week 6 | API Gateway êµ¬ì„± | â³ ëŒ€ê¸° | 0% |
| Week 7-8 | ëª¨ë‹ˆí„°ë§ & CI/CD | â³ ëŒ€ê¸° | 0% |

---

## âœ… ì™„ë£Œëœ ì‘ì—… (Week 1-5)

### Week 1-2: DDD Lite ì ìš©
- âœ… Bounded Context ë¬¸ì„œí™”
- âœ… Aggregate ì„¤ê³„
- âœ… Domain Events ì •ì˜
- âœ… Event Storming ë‹¤ì´ì–´ê·¸ë¨

### Week 3-4: Kafka í†µí•©
- âœ… Kafka Docker Compose ì„¤ì • (3 brokers)
- âœ… Kafka Producer/Consumer êµ¬í˜„
- âœ… Redis Pub/Sub â†’ Kafka ë§ˆì´ê·¸ë ˆì´ì…˜
  - âœ… ë©”ì‹œì§€ ì „ì†¡ (MessageSent ì´ë²¤íŠ¸)
  - âœ… ë©”ì‹œì§€ SSE ìŠ¤íŠ¸ë¦¬ë°
  - âœ… ì˜¨ë¼ì¸ ìƒíƒœ ë³€ê²½ (UserOnlineStatusChanged ì´ë²¤íŠ¸)
  - âœ… ì˜¨ë¼ì¸ ìƒíƒœ SSE ìŠ¤íŠ¸ë¦¬ë°
- âœ… Kafka í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
- âœ… Topic ìƒì„± ë° ê²€ì¦

### Week 5: MSA ì„œë¹„ìŠ¤ ë¶„ë¦¬ (í˜„ì¬)
- âœ… 4ê°œ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë””ë ‰í† ë¦¬ êµ¬ì¡° ìƒì„±
  - âœ… User Service (Port 8005) - **ì™„ì „ ë™ì‘**
  - âœ… Friend Service (Port 8003) - **ê¸°ë³¸ êµ¬ì¡° ì™„ë£Œ**
  - âœ… Chat Service (Port 8002)
  - âœ… Notification Service (Port 8004)
- âœ… User Service API êµ¬í˜„ ì™„ë£Œ
  - âœ… ì¸ì¦ API (íšŒì›ê°€ì…, ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ)
  - âœ… í”„ë¡œí•„ API (ì¡°íšŒ, ìˆ˜ì •, ì´ë¯¸ì§€ ê´€ë¦¬)
  - âœ… ì‚¬ìš©ì ê²€ìƒ‰ API
  - âœ… ëª¨ë“  ì—”ë“œí¬ì¸íŠ¸ í…ŒìŠ¤íŠ¸ ì™„ë£Œ
- âœ… Friend Service ê¸°ë³¸ êµ¬ì¡°
  - âœ… ê³µí†µ ëª¨ë“ˆ ë³µì‚¬ ì™„ë£Œ
  - âœ… ëª¨ë¸ ì •ì˜ (Friendship, BlockUser)
  - âœ… ì„œë¹„ìŠ¤ ì‹¤í–‰ í™•ì¸
- âœ… MSA ì „ì²´ ë¬¸ì„œ ì‘ì„± (services/README.md)

---

## ğŸš§ ì§„í–‰ ì¤‘ ì‘ì—…

### API ë§ˆì´ê·¸ë ˆì´ì…˜ (75% ì™„ë£Œ)

#### User Service - âœ… ì™„ë£Œ
- âœ… ì¸ì¦ API ì´ë™ (register, login, logout)
  - OAuth2 ë° JSON ë¡œê·¸ì¸ ì§€ì›
  - JWT í† í° ë°œê¸‰ ë° ê²€ì¦
- âœ… í”„ë¡œí•„ API ì´ë™ (profile, upload-image, delete-image)
  - í”„ë¡œí•„ ì¡°íšŒ ë° ìˆ˜ì •
  - ì´ë¯¸ì§€ ì—…ë¡œë“œ/ì‚­ì œ
- âœ… ì‚¬ìš©ì ê²€ìƒ‰ API ì´ë™
  - ì‚¬ìš©ìëª…/í‘œì‹œëª… ê²€ìƒ‰
  - ë³µìˆ˜ ì‚¬ìš©ì ì¡°íšŒ

#### Friend Service - âœ… ì™„ë£Œ
- âœ… ë””ë ‰í† ë¦¬ êµ¬ì¡° ë° ê³µí†µ ëª¨ë“ˆ
- âœ… Models (Friendship, BlockUser)
- âœ… ì¹œêµ¬ ê´€ê³„ API ì´ë™ (request, accept, reject, cancel)
  - POST /friends/request - ì¹œêµ¬ ìš”ì²­
  - PUT /friends/status/{requester_user_id} - ìˆ˜ë½/ê±°ì ˆ
  - GET /friends/list - ì¹œêµ¬ ëª©ë¡
  - GET /friends/requests - ì¹œêµ¬ ìš”ì²­ ëª©ë¡
  - DELETE /friends/request/{target_user_id} - ìš”ì²­ ì·¨ì†Œ
- âœ… ì‚¬ìš©ì ê²€ìƒ‰ API (GET /friends/search)
- âœ… FriendshipService ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì™„ì„±
- âœ… JWT ì¸ì¦ í†µí•©

#### Chat Service - ğŸš§ ì§„í–‰ì¤‘ (ê¸°ë³¸ êµ¬ì¡° ì™„ë£Œ)
- âœ… ë””ë ‰í† ë¦¬ êµ¬ì¡° ë° ê³µí†µ ëª¨ë“ˆ
- âœ… Models (ChatRoom, Message, RoomMember)
- â³ ì±„íŒ…ë°© API ì´ë™
- â³ ë©”ì‹œì§€ API ì´ë™ (send, read, stream)
- â³ Kafka Producer í†µí•©

#### Notification Service - â³ ëŒ€ê¸°
- â³ ì•Œë¦¼ API ì´ë™
- â³ SSE ìŠ¤íŠ¸ë¦¬ë° êµ¬í˜„

---

## ğŸ“‹ ë‹¤ìŒ ì‘ì—… (ìš°ì„ ìˆœìœ„)

### 1ë‹¨ê³„: í•µì‹¬ API ë§ˆì´ê·¸ë ˆì´ì…˜ (Week 5-6)
```
[High Priority]
1. User Service ì¸ì¦ API ì™„ì„±
   - ë¡œê·¸ì¸/íšŒì›ê°€ì… ê¸°ëŠ¥ í•„ìˆ˜
   - JWT í† í° ë°œê¸‰

2. Chat Service ë©”ì‹œì§€ API ì™„ì„±
   - ë©”ì‹œì§€ ì „ì†¡/ì¡°íšŒ
   - Kafka Consumer ì—°ë™

3. ì„œë¹„ìŠ¤ ê°„ ì˜ì¡´ì„± í•´ê²°
   - ê³µí†µ ëª¨ë“ˆ ì¶”ì¶œ
   - DTO/Schema ì •ì˜
```

### 2ë‹¨ê³„: API Gateway êµ¬ì„± (Week 6)
```
[Medium Priority]
1. Kong API Gateway ì„¤ì¹˜
2. ë¼ìš°íŒ… ê·œì¹™ ì„¤ì •
   - /api/auth/* â†’ User Service (8005)
   - /api/chat/* â†’ Chat Service (8002)
   - /api/friends/* â†’ Friend Service (8003)
3. CORS, Rate Limiting ì„¤ì •
```

### 3ë‹¨ê³„: Docker Compose í†µí•© (Week 6)
```
1. ì „ì²´ MSA ìŠ¤íƒ docker-compose.yml ì‘ì„±
2. ì„œë¹„ìŠ¤ ê°„ ë„¤íŠ¸ì›Œí¬ ì„¤ì •
3. í™˜ê²½ë³€ìˆ˜ ê´€ë¦¬ (.env)
4. ë³¼ë¥¨ ë§ˆìš´íŠ¸ ì„¤ì •
```

### 4ë‹¨ê³„: ëª¨ë‹ˆí„°ë§ & ë¡œê¹… (Week 7-8)
```
1. Prometheus + Grafana ì„¤ì •
2. ì¤‘ì•™ ë¡œê¹… (ELK Stack)
3. ë¶„ì‚° íŠ¸ë ˆì´ì‹± (Jaeger)
4. ì•ŒëŒ ì„¤ì • (Slack, Email)
```

---

## ğŸ—ï¸ í˜„ì¬ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Monolithic App (Port 8000)         â”‚
â”‚  - ëª¨ë“  APIê°€ í†µí•©ë˜ì–´ ì‹¤í–‰ ì¤‘                    â”‚
â”‚  - Kafka Producer/Consumer í†µí•© ì™„ë£Œ             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â–¼ ë§ˆì´ê·¸ë ˆì´ì…˜ ì§„í–‰ ì¤‘

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ User Service â”‚  â”‚ Chat Service â”‚  â”‚Friend Serviceâ”‚  â”‚Notification  â”‚
â”‚   (8005)     â”‚  â”‚   (8002)     â”‚  â”‚   (8003)     â”‚  â”‚  Service     â”‚
â”‚              â”‚  â”‚              â”‚  â”‚              â”‚  â”‚   (8004)     â”‚
â”‚ âœ… ì™„ì „ ë™ì‘  â”‚  â”‚ ğŸš§ êµ¬ì¡° ì™„ì„±  â”‚  â”‚ âœ… ì™„ì „ ë™ì‘  â”‚  â”‚ âœ… êµ¬ì¡° ì™„ì„±  â”‚
â”‚ âœ… API ì™„ë£Œ   â”‚  â”‚ â³ API ì´ë™   â”‚  â”‚ âœ… API ì™„ë£Œ   â”‚  â”‚ â³ API ì´ë™   â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                 â”‚                 â”‚                 â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    Kafka Event Bus (3 brokers)
              Topics: message.events, user.online_status, ...
```

---

## ğŸ¯ ëª©í‘œ ì•„í‚¤í…ì²˜

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ API Gateway  â”‚
                    â”‚  (Kong)      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â–¼                 â–¼                 â–¼              â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  User   â”‚      â”‚  Chat   â”‚      â”‚ Friend  â”‚   â”‚Notification â”‚
    â”‚ Service â”‚      â”‚ Service â”‚      â”‚ Service â”‚   â”‚  Service    â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
         â”‚                â”‚                â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          Kafka Event Bus

    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚              Observability Stack                       â”‚
    â”‚  - Prometheus (Metrics)                                â”‚
    â”‚  - Grafana (Visualization)                             â”‚
    â”‚  - ELK Stack (Logging)                                 â”‚
    â”‚  - Jaeger (Distributed Tracing)                        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”‘ ì£¼ìš” ê²°ì •ì‚¬í•­

### ê¸°ìˆ  ìŠ¤íƒ
- **ì–¸ì–´**: Python 3.9+
- **í”„ë ˆì„ì›Œí¬**: FastAPI
- **ë°ì´í„°ë² ì´ìŠ¤**: MySQL (User, Chat, Friend), MongoDB (Messages, Notifications), Redis (Cache)
- **ë©”ì‹œì§€ ë¸Œë¡œì»¤**: Kafka (3 brokers)
- **API Gateway**: Kong (ì˜ˆì •)
- **ì»¨í…Œì´ë„ˆ**: Docker, Docker Compose
- **ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜**: Kubernetes (ë¯¸ë˜)

### Port í• ë‹¹
| ì„œë¹„ìŠ¤ | Port | ìš©ë„ |
|--------|------|------|
| Monolithic API | 8000 | ê¸°ì¡´ ì• í”Œë¦¬ì¼€ì´ì…˜ |
| User Service | 8005 | ì‚¬ìš©ì ì¸ì¦/í”„ë¡œí•„ |
| Chat Service | 8002 | ì±„íŒ…/ë©”ì‹œì§€ |
| Friend Service | 8003 | ì¹œêµ¬ ê´€ê³„ |
| Notification Service | 8004 | ì•Œë¦¼ |
| API Gateway | 80/443 | ì™¸ë¶€ ì§„ì…ì  (ì˜ˆì •) |
| Kafka UI | 8080 | Kafka ëª¨ë‹ˆí„°ë§ |
| Grafana | 3000 | ë©”íŠ¸ë¦­ ì‹œê°í™” (ì˜ˆì •) |

### Kafka Topics
| Topic | Producer | Consumer | ì„¤ëª… |
|-------|----------|----------|------|
| `message.events` | Chat Service | Chat Service (SSE), Notification Service | ë©”ì‹œì§€ ì „ì†¡ ì´ë²¤íŠ¸ |
| `user.online_status` | User Service | Notification Service | ì˜¨ë¼ì¸ ìƒíƒœ ë³€ê²½ |
| `user.events` | User Service | - | ì‚¬ìš©ì ë“±ë¡/ìˆ˜ì • |
| `chat.events` | Chat Service | - | ì±„íŒ…ë°© ìƒì„± |
| `friend.events` | Friend Service | Chat Service, Notification Service | ì¹œêµ¬ ìš”ì²­/ìˆ˜ë½ |
| `notification.events` | Notification Service | - | ì•Œë¦¼ ì „ì†¡ ì™„ë£Œ |

---

## ğŸ“ ì°¸ê³  ë¬¸ì„œ

- [DDD Bounded Context](./docs/architecture/01-bounded-context.md)
- [Aggregate ì„¤ê³„](./docs/architecture/02-aggregate-design.md)
- [Domain Events](./docs/architecture/03-domain-events.md)
- [MSA ë§ˆì´ê·¸ë ˆì´ì…˜ ì „ëµ](./docs/architecture/04-msa-migration.md)
- [Kafka ì„¤ì •](./docs/kafka/01-kafka-setup.md)
- [ì„œë¹„ìŠ¤ README](./services/README.md)

---

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### Monolithic App ì‹¤í–‰ (í˜„ì¬)
```bash
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### User Service ì‹¤í–‰ (MSA)
```bash
cd services/user-service
python -m uvicorn main:app --host 0.0.0.0 --port 8005
```

### Kafka í´ëŸ¬ìŠ¤í„° ì‹¤í–‰
```bash
docker-compose -f infrastructure/docker/docker-compose-kafka.yml up -d
```

### Kafka í…ŒìŠ¤íŠ¸
```bash
python test_kafka.py
```

---

## âš ï¸ ì•Œë ¤ì§„ ì´ìŠˆ

1. **Port ì¶©ëŒ**: RedisInsightê°€ 8001ì„ ì‚¬ìš© ì¤‘ â†’ User Serviceë¥¼ 8005ë¡œ ë³€ê²½
2. **ì˜ì¡´ì„±**: ê° ì„œë¹„ìŠ¤ê°€ ì•„ì§ ê³µí†µ ëª¨ë“ˆì— ì˜ì¡´ â†’ ë³µì‚¬/ì¶”ì¶œ ì‘ì—… í•„ìš”
3. **Database ì—°ê²°**: ê° ì„œë¹„ìŠ¤ê°€ ë…ë¦½ì ìœ¼ë¡œ DB ì—°ê²° í’€ ê´€ë¦¬ í•„ìš”

---

## ğŸ“ Contact

ë¬¸ì œê°€ ë°œìƒí•˜ê±°ë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ë©´ GitHub Issuesì— ë“±ë¡í•´ì£¼ì„¸ìš”.

**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2026-01-27
**ì»¤ë°‹ í•´ì‹œ**: `bfb5786`
